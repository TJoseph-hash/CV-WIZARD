<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CV WIZARD</title>
</head>
<style>
  * {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  background-color: #f4f6f9;
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
}

/* Navbar */
nav {
  display: flex;
  justify-content: space-between;
  align-items: center;
  background-color: #d1cece;
  padding: 15px 90px;
}

nav img {
  height: 57px;
  background-color: #d1cece;
  padding: 5px;
  border-radius: 8px;
  
  
}



nav ul {
  display: flex;
  align-items: center;
  list-style: none;
  gap: 25px;
}

nav ul li {
  display: inline-block;
}

nav a, .auth-buttons a {
  color: #000000; 
  font-size: 20px; 
  font-weight: 700; 
  text-decoration: none;
  transition: color 0.3s ease;
}

nav a:hover, .auth-buttons a:hover {
  color: #555555; 
}

/* Auth buttons */
.auth-buttons {
  display: flex;
  gap: 15px;
}

/* Main Container */
#main-container {
  display: flex;
  height: calc(100vh - 70px); 
}

/* Sidebar */
#history-sidebar {
  width: 240px;
  background-color: #ffffff; 
  padding: 25px 20px;
  border-right: 1px solid #bbb;
  overflow-y: auto;
  height: 100%;
  box-shadow: 2px 0 10px rgba(0,0,0,0.1);
}

#history-sidebar::-webkit-scrollbar {
  width: 8px;
}

#history-sidebar::-webkit-scrollbar-track {
  background: #e0e0e0;
}

#history-sidebar::-webkit-scrollbar-thumb {
  background-color: #555555;
  border-radius: 4px;
}
 #jobDesc{
  resize: vertical;
}
#history-sidebar h3 {
  font-size: 24px;
  margin-bottom: 20px;
  color: #1a1a1a; 
  text-align: center;
  border-bottom: 2px solid #555;
  padding-bottom: 10px;
}

#history-list {
  list-style: none;
  padding: 0;
}

#history-list li {
  margin-bottom: 12px;
  font-size: 18px;
}

#history-list li a {
  text-decoration: none;
  color: #333333;
  display: block;
  padding: 8px 10px;
  border-radius: 5px;
  transition: background 0.3s;
}

#history-list li a:hover {
  background-color: #f0f0f0;
}

/* Form and Tailored Resume Section */
.form-tailor-wrapper {
  display: flex;
  flex: 1;
  padding: 30px;
  gap: 30px;
  background-color: #f4f6f9;
}

#uploadForm,
#tailer-res {
  flex: 1;
  background-color: #ffffff;
  padding: 25px;
  border-radius: 10px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.1);
  border: 1px solid #bbb;
  display: flex;
  flex-direction: column;
}

#uploadForm label {
  font-weight: 600;
  color: #333;
  font-size: 18px;
  margin-bottom: 10px;
}

input[type="file"],
textarea {
  padding: 12px;
  border: 2px solid #555; 
  border-radius: 8px;
  font-size: 16px;
  background-color: #fff;
  margin-bottom: 20px;
}
@media (max-width: 768px) {
  * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
  
  }
  #main-container {
    display: flex;
  height: calc(100vh - 70px);
  overflow-x: auto; /* Enable horizontal scrolling */
  white-space: nowrap;
  }
   nav{
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    align-items: center;
    background-color: #d1cece;
    padding: 15px 90px;
   }
  #main-container {
    flex-direction: column; /* Stack the main container's children vertically */
  }

  #history-sidebar {
    width: auto;
    background-color: #ffffff;
    padding: 25px 20px;
    border-right: 1px solid #bbb;
    overflow-y: auto;
    height: 100%;
    box-shadow: 2px 0 10px rgba(0, 0, 0, 0.1);
  }

  .form-tailor-wrapper {
    flex-direction: column; /* Stack the form and tailored resume vertically */
    order: 2; /* Ensure the form and tailored resume come after the history section */
    justify-content: center;
    height: 100%; /* Set the height of the div to 900px */

  }

  #uploadForm {
    order: 1; /* Ensure the form appears first within the form-tailor-wrapper */
  }

  #tailer-res {
    order: 2; /* Ensure the tailored resume appears below the form */
    margin-top: 20px; /* Add spacing between the form and the tailored resume */
    flex: 1;
    background-color: #ffffff;
    padding: 25px;
    border-radius: 10px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    border: 1px solid #bbb;
    display: flex;
    flex-direction: column;
    
  }
  #newresume {
    font-family: 'Georgia', 'Times New Roman', serif; 
    font-size: 16px; 
    line-height: 1.5; 
    padding: 12px;
    border: 1px solid #ccc;
    border-radius: 8px;
    background-color: #fff;
    resize: none;
  }
}


button {
  padding: 12px 18px;
  background-color: #1a1a1a;
  color: #ffffff;
  font-weight: 600;
  border: none;
  border-radius: 8px;
  cursor: pointer;
  transition: background-color 0.3s ease;
  margin-top: 20px;
}

button:hover {
  background-color: #333333;
}

#tailer-res h3 {
  margin-bottom: 15px;
  font-size: 24px;
  color: #1a1a1a;
}

#newresume {
  width: 100%;
  height: 100%;
  border: 2px solid #555;
  border-radius: 8px;
  font-size: 15px;
  padding: 12px;
  background-color: #ffffff;
  
}

/* Job Description and Tailored Resume Textareas */
#jobDesc,
#newresume {
  font-family: 'Georgia', 'Times New Roman', serif; 
  font-size: 16px; 
  line-height: 1.5; 
  padding: 12px;
  border: 1px solid #ccc;
  border-radius: 8px;
  background-color: #fff;
  resize: vertical;
}


</style>

  
<body>


<nav>
   <img src="images/CV_Wizard_logo-removebg-preview.png" alt="company logo">
    <ul>
      <li><a href="index.html">Home</a></li>

    
      
    </ul>
</nav>

<div id="main-container">
  
  <!--History Sidebar-->
  <aside id="history-sidebar">
    <h3>History</h3>
    <ul id="history-list">
      <!-- History items go here -->
    </ul>
  </aside>
<br>
  <!-- Form and Resume Side by Side -->
  <div class="form-tailor-wrapper">
    
    <form id="uploadForm">
      <label for="resume">Upload Resume (PDF/DOCX):</label>
      <input type="file" id="resume" accept="application/pdf" required>

      <label for="jobDesc">Job Description:</label>
      <textarea id="jobDesc" rows="6" accept="application/txt" required></textarea>

      <button type="submit">Tailor Resume</button>
    </form>

    <div id="tailer-res">
      <h3>Tailored Resume:</h3>
      <textarea id="newresume"></textarea>
    </div>

  </div>
</div>
<script>
  document.getElementById("uploadForm").addEventListener("submit", async (e) => {
    e.preventDefault();
  
    const resumeFile = document.getElementById("resume").files[0];
    const jobDescription = document.getElementById("jobDesc").value;
  
    if (!resumeFile || !jobDescription) {
      alert("Please provide both the resume and job description.");
      return;
    }
  
    const formData = new FormData();
    formData.append("resume", resumeFile);
    formData.append("jobDescription", jobDescription);
  
    const response = await fetch("http://localhost:3000/api/tailor-resume", {
      method: "POST",
      body: formData,
    });
  
    const result = await response.text();
    document.getElementById("newresume").value = result;
  
    // Save the tailored resume to localStorage
    const title = prompt("Enter a title for this tailored resume:");
    if (title) {
      let resumes = JSON.parse(localStorage.getItem("resumes") || "[]");
      resumes.push({ title, content: result });
      localStorage.setItem("resumes", JSON.stringify(resumes));
      loadResumes();
    }
  });
  
  // Load saved resumes on page load
  window.onload = () => {
    loadResumes();
  };
  
  // Load and display the saved resumes in sidebar
  function loadResumes() {
    const resumeList = document.getElementById("history-list");
    resumeList.innerHTML = "";

    const resumes = JSON.parse(localStorage.getItem("resumes") || "[]");

    resumes.forEach((resume, index) => {
        const div = document.createElement("div");
        div.className = "resume-entry";
        div.style.color = "white";
        div.style.marginBottom = "1rem";
        div.style.cursor = "pointer";

        // Add title
        const title = document.createElement("span");
        title.textContent = resume.title;
        title.style.cursor = "pointer";
        title.onclick = () => loadResume(index);

        // Add download link
        const downloadLink = document.createElement("a");
        downloadLink.textContent = `${resume.title}.txt`;
        downloadLink.style.marginLeft = "10px";
        downloadLink.style.color = "#0077b6";
        downloadLink.style.textDecoration = "none";
        downloadLink.href = `data:text/plain;charset=utf-8,${encodeURIComponent(resume.content)}`;
        downloadLink.download = `${resume.title}.txt`;

        // Add delete button
        const delBtn = document.createElement("button");
        delBtn.textContent = "Delete";
        delBtn.style.marginLeft = "10px";
        delBtn.style.background = "transparent";
        delBtn.style.border = "none";
        delBtn.style.color = "red";
        delBtn.style.cursor = "pointer";
        delBtn.onclick = (e) => {
            e.stopPropagation();
            deleteResume(index);
        };

        div.appendChild(title);
        div.appendChild(downloadLink);
        div.appendChild(delBtn);
        resumeList.appendChild(div);
    });
  }
  
  // Load resume content into textarea
  function loadResume(index) {
    const resumes = JSON.parse(localStorage.getItem("resumes") || "[]");
    const resume = resumes[index];
    document.getElementById("newresume").value = resume.content;
    currentlyLoadedResume = index;
  }
  
  // Save edited resume content
  function saveEditedResume() {
    const content = document.getElementById("newresume").value;
    let resumes = JSON.parse(localStorage.getItem("resumes") || "[]");
  
    if (typeof currentlyLoadedResume === "number" && resumes[currentlyLoadedResume]) {
      resumes[currentlyLoadedResume].content = content;
      localStorage.setItem("resumes", JSON.stringify(resumes));
      alert("Resume updated!");
      loadResumes();
    } else {
      alert("No resume selected to update.");
    }
  }
  
  // Delete a resume from the sidebar and storage
  function deleteResume(index) {
    const resumes = JSON.parse(localStorage.getItem("resumes") || "[]");
    const confirmDelete = confirm(`Delete "${resumes[index].title}"?`);
    if (confirmDelete) {
      resumes.splice(index, 1);
      localStorage.setItem("resumes", JSON.stringify(resumes));
      loadResumes();
      document.getElementById("newresume").value = ""; // Clear editor
    }
  }
  
  // Keep track of the currently selected resume for editing
  let currentlyLoadedResume = null;

</script>
</body>
</html>


